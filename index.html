<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>D' Best Site</title>
  <link rel="stylesheet" href="style.css" />
  <script type="module" src="rating.js"></script>
  <script type='text/javascript' src='//swollenbasis.com/10/24/b0/1024b00b714752a34b3ca526c2508afc.js'></script>
</head>
<body>
  <header>
    <h1>D' Best Site</h1>
    <input type="text" id="search" placeholder="Search videos..." />
  </header>
  
  <main>
    <div id="tag-filter"></div>
	  <div class="adgrid">
		  <div id="ad1"></div><div id="ad2"></div><div id="pcad1"></div><div id="pcad2"></div>


	  </div>
    <div id="video-container" class="grid"></div>
	  <div class="adgrid">
		  <div id="ad3"></div><div id="ad4"></div><div id="pcad3"></div><div id="pcad4"></div>
	  </div>

   

    <div id="pagination" class="pagination-controls"></div>
	  
  </main>

  <footer style="background-color:#121917; color:#b8f1d9; padding:20px 10px; text-align:center; font-family: Arial, sans-serif; font-size: 0.9rem; margin-top: 40px;">
  <p>Â© 2025 D' Best Site. All rights reserved.</p>
  <p>
    <a href="#" style="color:#b8f1d9; text-decoration:none; margin: 0 10px;">Privacy Policy</a> |
    <a href="#" style="color:#b8f1d9; text-decoration:none; margin: 0 10px;">About Us</a> |
    <a href="#" style="color:#b8f1d9; text-decoration:none; margin: 0 10px;">Contact</a>
  </p>
</footer>



  	
<script type="module">
  import { setupFooterPopup } from './footer.js';
  setupFooterPopup();
</script>


<script type="module">
  import { insertBannerAd } from './adBanner.js';

  // Insert banner ads in multiple places if you want
  insertBannerAd('ad1');
  insertBannerAd('ad2');  // duplicate in another container
  insertBannerAd('ad3');
  insertBannerAd('ad4');
</script>


<script type="module">
  import { insertBannerAd } from './pcAds.js';

  window.addEventListener('DOMContentLoaded', () => {
    ['pcad1', 'pcad2', 'pcad3','pcad4'].forEach(id => insertBannerAd(id));
  });
</script>

	

	
  <script type="module">
    import { setupRatingSystem } from './rating.js';

    const videoContainer = document.getElementById("video-container");
    const searchInput = document.getElementById("search");
    const tagFilter = document.getElementById("tag-filter");
    const pagination = document.getElementById("pagination");

    let videoData = [];
    let filteredData = [];
    let currentPage = 1;
    const videosPerPage = 5;
    let activeTag = null;

    fetch('videos.json')
      .then(res => res.json())
      .then(data => {
        // Sort newest first
        videoData = data.reverse();
        initFilters();
        applyFilters();
      });

    function initFilters() {
      const allTags = [...new Set(videoData.flatMap(v => v.tags))];

      allTags.forEach(tag => {
        const btn = document.createElement("button");
        btn.textContent = tag;
        btn.onclick = () => {
          activeTag = activeTag === tag ? null : tag;
          applyFilters();
        };
        tagFilter.appendChild(btn);
      });

      searchInput.addEventListener("input", () => {
        applyFilters();
      });
    }

    function applyFilters() {
      const term = searchInput.value.toLowerCase();
      filteredData = videoData.filter(v =>
        v.title.toLowerCase().includes(term) &&
        (!activeTag || v.tags.includes(activeTag))
      );

      currentPage = 1;
      renderPagination();
      renderVideos();
    }

    function renderPagination() {
      pagination.innerHTML = "";
      const totalPages = Math.ceil(filteredData.length / videosPerPage);

      for (let i = 1; i <= totalPages; i++) {
        const btn = document.createElement("button");
        btn.textContent = i;
        btn.className = i === currentPage ? "active" : "";
        btn.onclick = () => {
          currentPage = i;
          renderVideos();
          renderPagination();
        };
        pagination.appendChild(btn);
      }
    }

    function renderVideos() {
  videoContainer.innerHTML = "";
  const start = (currentPage - 1) * videosPerPage;
  const end = start + videosPerPage;
  const pageVideos = filteredData.slice(start, end);

  pageVideos.forEach(video => {
    const card = document.createElement("div");
    card.className = "video-card";

    card.innerHTML = `
      <h3>${video.title}</h3>
      <video src="${video.url}" controls playsinline controlsList="nodownload"></video>
      <div class="tags">${video.tags.map(t => `<span>#${t}</span>`).join(' ')}</div>
      <div class="rating-box" id="rating-${video.postId}">Loading rating...</div>
    `;

   

    videoContainer.appendChild(card);

    setupRatingSystem(video.postId, video.votes || 0, video.sum || 0);
  });
}

    // Disable right click globally
    document.addEventListener("contextmenu", e => e.preventDefault());

    function checkVideoVisibility() {
  document.querySelectorAll("video").forEach(video => {
    const rect = video.getBoundingClientRect();
    const videoHeight = rect.height;
    const scrolledOut = rect.bottom < window.innerHeight - (videoHeight * 0.2);

    if (scrolledOut && !video.paused) {
      video.pause();
    }
  });
}

window.addEventListener("scroll", checkVideoVisibility);
  </script>
</body>
</html>
